package com.test.demo.htstrix;import com.netflix.hystrix.HystrixCommand;import com.netflix.hystrix.HystrixCommandGroupKey;import com.netflix.hystrix.HystrixObservable;import com.netflix.hystrix.strategy.concurrency.HystrixRequestContext;/** * @author 赵乾泽 * @version 1.0 * @title * @description * @created 2020/7/13 11:44 下午 * @changeRecord */public class HelloWorldCommandCacheDemo extends HystrixCommand<Boolean> {    private final int value;    protected HelloWorldCommandCacheDemo(int value) {        super(HystrixCommandGroupKey.Factory.asKey("ExampleGroup"));        this.value = value;    }    @Override    protected Boolean run() {        return value == 0 || value % 2 == 0;    }    /**     * 该方法取到缓存的值将不执行 run() 方法     * @return     */    @Override    protected String getCacheKey() {//        return String.valueOf(value);        return String.valueOf(2);    }    @Override    protected Boolean getFallback() {        System.out.println("fallback: true");        return true;    }//    public static void main(String[] args) {//        HystrixRequestContext context = HystrixRequestContext.initializeContext();//        HelloWorldCommandCacheDemo cacheDemo = new HelloWorldCommandCacheDemo(2);//        HelloWorldCommandCacheDemo cacheDemo1 = new HelloWorldCommandCacheDemo(1);//        HelloWorldCommandCacheDemo cacheDemo2 = new HelloWorldCommandCacheDemo(0);//        HelloWorldCommandCacheDemo cacheDemo3 = new HelloWorldCommandCacheDemo(58672);////        System.out.println(cacheDemo.execute());//        System.out.println(cacheDemo1.execute());//        System.out.println(cacheDemo2.execute());//        System.out.println(cacheDemo3.execute());////        context.shutdown();//    }    public static void main(String[] args) {        HystrixRequestContext context = HystrixRequestContext.initializeContext();        try {            HelloWorldCommandCacheDemo command2a = new HelloWorldCommandCacheDemo(2);            HelloWorldCommandCacheDemo command2b = new HelloWorldCommandCacheDemo(2);            System.out.println(command2a.execute());            // this is the first time we've executed this command with            // the value of "2" so it should not be from cache            System.out.println(command2a.isResponseFromCache());            System.out.println(command2b.execute());            // this is the second time we've executed this command with            // the same value so it should return from cache            System.out.println(command2b.isResponseFromCache());        } finally {            context.shutdown();        }        // start a new request context        context = HystrixRequestContext.initializeContext();        try {            HelloWorldCommandCacheDemo command3b = new HelloWorldCommandCacheDemo(2);            System.out.println(command3b.execute());            // this is a new request context so this            // should not come from cache            System.out.println(command3b.isResponseFromCache());        } finally {            context.shutdown();        }    }}